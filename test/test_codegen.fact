public int32 foo() {
  public bool x = true;
  public int32 y = 22;
  public uint32 z = 23;
  secret bool t = x;
  public int16 zz = (int16)z;

  public mut int32[] arr = { 2, 5, 3 };
  arr[2] = 7;

  public bool t_pub = declassify(t);

  secret int32 y_ = -25;
  public int32 yy = -y;
  public int32 yy_ = ~y;
  public bool xx = !x;

  secret int32 ttt = y | y_;
  secret int32 xxy = x ? yy : yy_;

  return y;
}

public bool baz(secret int32 x, public mut bool y) {
  return false;
}

public bool qux(secret int32 x, public mut bool y) {
  foo();
  return baz(x, ref y);
}

public int32 bar() {
  secret int32 x = foo();
  public mut bool yyy = false;
  public mut bool y = baz(4, ref yyy);
  secret mut int32 z = x;

  y = x;
  if (x + 4) {
    //y = x; INVALID because y is public and control flow (x+4) is secret
  } else if (x + 3) {
    z = y;
  } else {
    z = x + x;
  }

  for (int32 xx = 0 to 6) {
    z = y;
  }

  baz(x, ref y);
  return 7;
}

void inject() {
  secret bool x = true;
  secret int32 y = 4;
  secret int32 z = 5;

  secret int32 t = x ? y : z;
}

public uint32 zzz(public uint8[4] buf) {
  return len buf;
}

public uint32 yyy(public uint8[4] buf) {
  return zzz(buf);
}

public bool bugfixes(public int32 x) {
  return x >= 4;
}

void fact_memzero(secret mut uint8[] buf) {
  for (uint32 i = 0 to len buf) {
    buf[i] = 0;
  }
}

void accept_var_len_array(secret uint8[] m) { }

void pass_var_len_array(secret uint8[] m) {
  accept_var_len_array(m);
}